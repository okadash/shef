#!/bin/sh
# shef: a package manager mock for shelib module packages

shef(){

shef_pkg_search(){ echo searching..., searched!; }

# simply list shelib package directory
shef_pkg_list(){ 
  for shef_i in ${SHELIB_DIR:?SHELIB_DIR not set}/*; do
    . $shef_i/manifest; echo -e `basename $shef_i`-${SHELIB_MODULE_VERSION:-nover}\\\t${SHELIB_MODULE_DESC:-no description}
  done | tabfix
}

shef_pkg_info(){
  for shef_i in ${SHELIB_DIR:?SHELIB_DIR not set}/*; do
    test `basename $shef_i` = "$1" && {
      echo -e Name\\\t\\\t`basename $shef_i`
      echo -e Version\\\t\\\t${SHELIB_MODULE_VERSION:-nover}
      echo -e Auther\\\t\\\t${MODULE_AUTHER_NAME:-unknown auther} \<${MODULE_AUTHER_EMAIL:-unknown email}\> 
      echo -e Description\\\t\\\t${SHELIB_MODULE_DESC:-no description}
      echo -e Components\\\t\\\t`ls $shef_i | grep -vE \^manifest\$`
      echo -e Requirement\\\t\\\tno info
    } | tabfix

  done
}

shef_pkg_install(){ echo downloading..., installed!; }
shef_pkg_remove(){ echo removing... removed; }


#SHELIB_SUBCOMMANDS
parsecmds(){
  case $1 in 
    search) #pkgdesc
    ## search package with description
    setexec shef_pkg_search ;;

    list)
    ## show installed package list
    setexec shef_pkg_list ;;

    info) #pkgname
    ## show information about the package
    setexec shef_pkg_info $2 ;;

    install) #pkgname
    ## install packege with name
    setexec shef_pkg_install ;;

    remove) #pkgname
    ## remove packege with name
    setexec shef_pkg_remove ;;

    *)
    setexec showhelp;;
  esac
}
#SHELIB_SUBCOMMANDS

}
cook shef $@
